Magic Lantern 0.2 for Canon 550D, Firmware 1.0.9
================================================


Features
--------

* GUI menus: press the ERASE button to display them
* Bit rate control (QScale parameter) for the H.264 encoder
* Zebra stripes for overexposed / underexposed areas
* Spotmeter, histogram
* Cropmarks (16:9, Cinemascope, Fisheye)
* Intervalometer (classic or HDR)
* Trap Focus: camera takes a picture when something comes in focus
* Remote release with either the LCD face sensor or audio trigger
* Rack focus
* Stack focus (Live View only)
* Lens data computation 
* Onscreen audio meters
* Manual audio gain, selectable input source, disable AGC and digital filters
* Display time remaining during video recording
* Debug functions (display CMOS temperature, screenshot, logging)
* Fine tuning for ISO and shutter speeds; also ISO 25600
* Kelvin white balance
* Clean LiveView display without any overlays (selectable)
* On-demand auto tuning for ISO, shutter & kelvin white balance
* Quick access to some useful settings like HTP, ALO and contrast

Known issues
------------

* Stack focus only works in Live View, after going through Play mode first. 
  Sometimes, rack & stack focus simply refuse to work, and you need to restart your camera.
* After closing ML menu, screen may not redraw automatically 
  (half-press the shutter or press ``MENU`` to trigger a redraw)
* Sometimes the menu gets overwritten by Canon's drawing routines, or flickers. 
* Camera may become unstable if you change modes while ML menu is active.
* Audio monitoring does not work. We don't know how to enable it 
  without breaking USB and maybe other functions. If you need this feature, 
  please uncomment the last line from ``hotplug.c`` and build a custom ``autoexec.bin``.
  Do this at your own risk, since this may cause other problems, too.


Important notes
---------------

* If you have a bootable SD card and have the ``DISKBOOT`` flag 
  set in the camera (which the installer does), and you do not have 
  an ``AUTOEXEC.BIN`` file on the card the camera **WILL NOT BOOT!**
  It will hang and not wake up until the battery is removed.
  
* If you encounter a "locked up" camera, **quickly remove the battery**.
  Otherwise the ARM might be in a tight-loop and get very hot, very quickly. 
  Your battery will run down and your LCD might show some discoloration.
  
* When in doubt, remove the battery and reboot. 

* **And, remember that this software can damage or destroy your camera.**


Menu options
------------

Press ERASE button to show the menu. Use arrows to navigate, ``SET`` to change values forwards
and ``DISP`` to change values backwards.

Audio
~~~~~

.. image:: AudioMenu-550D.png
    :alt: thumb|right|Audio menu

Audio tweaks.

**AudioMeter: ON/OFF/MovOnly**
  Draw the audio meters or not. The ``MovOnly`` settings enables audio meters in movie mode only (default).

**Output vol (dB)**
  Gain to external audio - currently this is the A/V jack (?) so not audible on just the camera

**Analog Gain (dB)**
  Gain applied to both inputs in the analog domain - intended as mic-type preamp, but always preferable to digital gain (unless you want different gain or run out of analog).

**L-DigiGain and R-DigiGain (dB)**
  Digital gain applied separately to the L and R channel.

**AGC: ON/OFF**
  Enable/disable Automatic Gain Control. Turn this to OFF to prevent hiss noise when recording silence.

**Filters: ON/OFF**
  Enable/disable digital audio filters (High Pass Filter, Low Pass Filter and stereo emphasis)

**Input**
  Input source: 
  
  * **internal mic**
  * **int L ext R**
  * **ext stereo**
  * **int L ext Bal** (internal Left + Right from both external pins as balanced audio)
  * **Auto int/ext**: camera detects if a mic is plugged in. Int is dual mono, ext is stereo.

Video
~~~~~

.. image:: VideoMenu-550D.png
    :alt: thumb|right|Video menu


Video overlays: histogram, zebras, cropmarks, spotmeter.

**Global Draw: ON/OFF**
  Enable/disable drawing extra graphics elements 
  (zebra, cropmarks, histogram, spotmeter, audio meters).

  Tip: use this to quickly turn them off.

**Histogram: ON/OFF**
  Show a histogram for the luma (Y) channel of the LiveView image. Colorspace is YUV.

**Zebras: ON/OFF/Auto**
  Enable/disable zebra stripes, which indicate overexposed or underexposed areas.
  
  Auto setting: zebras are disabled while recording.

**ZebraThrLO, ZebraThrHI**
  Thresholds for underexposure and overexposure. 
  Brightness values are between 0 and 255.

**CropM**
  Select cropmarks (cycle between the configured ones).

  There are 3 predefined cropmarks in the zip archive:
  HD with Title & Action Safe and Cinemascope provided by *CameraRick* from the ``cinema5d`` forum, 
  and a cropmark for framing fisheye stills with Samyang/8mm.

.. image:: Cropmarks550D.png
    :alt: 400px|center

  If you use custom cropmarks, you have to set their name manually in the config file.
  See the "Hidden settings" section. You can configure max. 3 cropmark files, and give them 
  short 8:3 names.
  
  An exclamation mark (!) displayed in the menu means "File not found". 
  
  Get more cropmarks created by Magic Lantern users here: `cropmarks-550D.zip <https://bitbucket.org/hudson/magic-lantern/downloads/cropmarks-550D.zip>`_
  
  See [[Cropmarks]] for how to create custom cropmarks. Tip: use ``Debug->Screenshot`` to get a bitmap with the correct palette.

{{clr}}

**Spotmeter: ON/OFF/Hidden**
  Measure brightness in the center of the frame, and display it as a percentage.

  Indicator is at the bottom on the screen, centered horizontally. It displays 
  a small marker in the center of the screen. If the current cropmark already includes
  a center marker, select the Hidden option.

**ClrScr: OFF/HalfShutter/Always**
  
  **HalfShutter**: Hold the shutter half-pressed, or the ``*`` button, or DOF preview for around 1 second,
  and this will clear all the overlays from the Live View display (audio, zebra, crops, shutter speeds...).
  It allows you to compose the picture without any extra distractions. 
  
  
  This works best when autofocus is assigned to the ``*`` button (from Custom Functions, set CFn.9 to 1: ``Shutter/AE lock button`` = ``AE lock/AF``).
  
  
  Tip: also use it for cleaning up unwanted Magic Lantern garbage left on the screen.
  
  
  **Always**: In this mode, all the overlays are erased from the screen (100% clean display). Zebras & friends are still available when you enter the Q menu, and then disappear.

Shoot
~~~~~

.. image:: ShootMenu-550D.png
    :alt: thumb|right|Shoot menu

Functions for stills shooting.

**IntervalTime**
  Time delay for intervalometer, in seconds.

**Intervalometer: ON/OFF**
  Start/stop intervalometer.
  
  * In photo mode, it takes a sequence of photos with a fixed delay. 
  * In movie mode, it takes a sequence of very small videos
    - You can adjust the duration of the videos by editing ``magic.cfg`` and changing ``interval.movie.duration``.
    - When ``HDR Bracket`` is active, each movie will be exposed according to the bracketing settings, and the duration of the movie will be multiplied by number of exposures.
  
  Tips:
  
  * shoot in manual mode and switch the lens to MF.
  
  * for power saving, cover the LCD sensor with something.
  
  * to save the shutter count when doing timelapses, switch to Movie mode.

**LCD RemoteShot: OFF/Near/Away**
  Start/stop remote shutter release mode with the LCD sensor. 
  
  * **Near**: To take a picture, put your hand near the LCD sensor.
  * **Away**: Picture is taken when you get your hand away from the sensor.

  This is useful for avoiding camera shake without extra $$$, 
  especially if you don't have a sturdy tripod.
  
  To use it, select one of P,S,A,M modes, turn OFF Live View, 
  and make sure "LCD auto off" is enabled (in the Canon menu, wrench 1).
  
  If self-timer is on, this function will disable it.

**Audio Rem.Shot: ON/OFF**
  Start/stop remote audio trigger. To take a picture, make some loud noise, for example, clap your hands.
  
  
  Audio threshold can be set from ``magic.cfg`` by changing ``audio.release.level`` (default 700), or by adjusting the audio volume.
  
  
  You can also start movie recording with this feature.
  
  
  In photo mode, you can combine this option with the self-timer (may be useful for group or self pictures).
  
  
  Be careful: this may trigger the shutter from the sounds made by camera (like focus beep or liveview switch).


You can stop the intervalometer and remote shooting modes either frrom ML menu, or by pressing ``PLAY`` or ``MENU``.

**HDR Bracket**
  AE Bracketing for HDR images and timelapses.
  
  
  Select number of images with ``SET`` and step size with ``DISP``. To turn this off quickly, press ``Q``.
  
    
  In ``M`` mode, this function does shutter bracketing. In the other modes it does exposure compensation bracketing.


  HDR images can be taken with:
  
  * ML remote triggers: LCD face sensor & audio trigger.
  * ML intervalometer (for HDR timelapse)
  * Press the shutter. In this case, the first image will have the middle exposure (without EV compensation), and the 2-second self-timer will be used.

  
  For each HDR picture set, Magic Lantern also writes a bash script for stacking the exposures
  with `**enfuse** <http://wiki.panotools.org/Enfuse>`_. The scripts are stored in ``DCIM/###CANON`` and are named after the first picture in set, 
  e.g. if the HDR sequence is created from ``IMG_1001.JPG ... IMG_1005.JPG``, the HDR script will be named 
  ``HDR_1001.SH`` and the resulting HDR image will be saved as ``HDR_1001.JPG``.
  

  To run the HDR scripts on the computer, move the scripts and the JPGs in the same directory and run (for example)::
  
        bash HDR_1001.SH

  or, for processing all the images at once::
  
        for f in $(ls *.SH); do bash $f ; done 

  On Windows, you can use Cygwin or MSYS to run the scripts.

  
  Don't forget to delete the scripts from the card; the camera won't delete them!
  
**Trap Focus: ON/OFF**
  You hold the shutter half-pressed; camera takes a picture when something comes into focus.
  
  This works if the lens is set to Manual focus (MF) and outside Live View. It does not work with lenses without chip.

Expo
~~~~

Adjusting the exposure parameters

**ISO**
  Custom steps for ISO. Possible values:
  
  0 (Auto), 100, 110, 115, 125, 140, 160, 170, 185, 200, 220, 235, 250, 280, 320, 350, 380, 400, 435, 470, 500, 580, 640, 700, 750, 800, 860, 930, 1000, 1100, 1250, 1400, 1500, 1600, 1750, 1900, 2000, 2250, 2500, 2750, 3000, 3200, 3500, 3750, 4000, 4500, 5000, 5500, 6000, 6400, 7200, 8000, 12800, 25600.
  
  To get ISO values higher than 6400, turn on ISO Expansion from Custom Functions (CFn 1). To get ISO lower than 200, turn HTP off. 
  In video mode, ISO only goes up to 6400. These is also true without ML.
  
  In manual exposure modes (photo and video), press the ``Q`` button on this entry to set the ISO value automatically. 
   
  * When LiveView is active, a binary search algorithm is used; the search criteria is a good balance between overexposure and underexposure; search resolution is 1/8EV. If the contrast is very low, the histogram will be centered.
  * When LiveView is off, ISO is set using the Auto ISO feature from Canon firmware, in 1EV steps.

**Shutter**
  Custom steps for shutter speed. Possible values:
  
  1/30, 33, 37, 40, 45, 50, 53, 57, 60, 67, 75, 80, 90, 100, 110, 115, 125, 135, 150, 160, 
  180, 200, 210, 235, 250, 275, 300, 320, 360, 400, 435, 470, 500, 550, 600, 640, 720, 800,
  875, 925, 1000, 1100, 1200, 1250, 1400, 1600, 1750, 1900, 2000, 2150, 2300, 2500, 2800, 3200,
  3500, 3750, 4000.
  
  In manual exposure modes (photo and video), press the ``Q`` button on this entry to set the shutter value automatically.
  
  * When LiveView is active, a binary search algorithm is used; the search criteria is a good balance between overexposure and underexposure; search resolution is 1/8EV. If the contrast is very low, the histogram will be centered.
  * When LiveView is off, the shutter value is computed with the help of Auto ISO feature from Canon firmware, in 1EV steps. This feature is still experimental and sometimes it does not work.

**WhiteBal**
  Kelvin white balance. Range: 1700 ... 10000.

  In LiveView, press the ``Q`` button on this entry to set the WB temperature using the center color as reference gray. The measurement area is 200x200 pixels, centered.

**Contrast**
  Adjusts the contrast of the current picture style. Range: -4...4.
  
  ``WARNING 1``: this will modify your current picture style.
  
  ``WARNING 2``: this was not tested with custom picture styles loaded with the EOS Utility (and it might have negative effects)!

**LightAdj: OFF/ALO hi/HTP**
  Select the light adjustment algorithm: 
  
  * OFF
  * Auto Lighting Optimizer (strong)
  * Highlight Tone Priority.
  
Brack
~~~~~

Bracketing was replaced by ``HDR Bracket`` feature from the ``Shoot`` menu, and it is no longer available. The source code is still there, you can enable it from Makefile and create a custom build.

Focus
~~~~~

.. image:: FocusMenu-550D.png
    :alt: thumb|right|Focus menu

**Focus dir**
  This is the direction the lens moves when pressing the camera's Zoom Out button to set the focus start and end points.

**Focus A**
    This is end point of rack focus. To set, focus the lens with the Zoom Out button, then press "Set". 

**Rack Focus**
    Triggers the rack focus operation that moves between the start and end focus points. After the move is complete pressing again reverses the move. 

**Run Stack focus**
  This selection will shoot a series of photographs with varying focal distances. You can also call this "focus bracketing".
  It is used in macro photography to assemble sharper final images by merging photos where each has a different focus point. 
  
  To configure focus step and number of photos, use the hidden settings ``focus.step`` and ``focus.count``.

The following items are display only:

**Focal Dist**
    The distance to the focal point. Value is returned by most newer Canon lenses. If the lens does not report any distance information, 0 will be displayed and the DOF calculations will not be correct. 
    
    See also [[Focus distance]].

**Hyperfocal**
    The hyperfocal distance is the point of focus where everything from half that distance to infinity falls within the depth of field. This is the largest depth of field possible for the current f-number. 

**DOF Near**
    The nearest distance in which objects appear in focus. 

**DOF Far**
    The farthest distance in which objects appear in focus. 

See also the description from the `5D2 ML User Guide <http://magiclantern.wikia.com/wiki/Magic_Lantern_0.1.6_User_Manual#Focus_menu>`_.

**How rack focus works**

Now that you know what the buttons are about, here is how you make it work:

1. After opening the focus menu, pick the end point of your rack focus, focusing manually with your lens on that point.

2. Next on the Focus Menu, select the direction you will have to focus to in order to find the start point. If the start point is a closer focus, pick ``Near``, if it a farther away focus point, pick ``Far``. ( Remember, you are simply telling camera which direction to go to find the start point.)

3. Next, scroll down to ``Focus A``. You need to zero this setting out, before going on. Press ``Set`` to zero it out.

4. Once that is completed you will use the ``Zoom Out`` button in the right hand upper corner of the back of the camera to move the focus point to your start point.

5. Next select the time period of the pull, by scrolling down to rack speed. The lower the number, the longer the rack will take. It is recommended for testing purposes to start around 20.

6. Next, start movie recording (you can do that while ML menu is active).

7. Once the camera is recording, scroll to ``Rack Focus``. To start the rack focus, press ``Set``. You should see the rack focus commence and complete its cycle.

8. To return to the beginning point, you can press ``Set`` again to return to that point, once again.

**Note:** the rack focus command may "stutter" while racking with some lenses, causing overshoot or undershoot of the desired position. This feature is still under development and should be more mature in a later version.

Debug
~~~~~

.. image:: DebugMenu-550D.png
    :alt: thumb|right|Debug menu

**QScale**
  Controls the H.264 QScale parameter, which affects video bitrate. 
  Lower values mean higher bitrates. OFF disables QScale control.
  
  When QScale is enabled, camera records in VBR mode (variable bitrate). 
  When QScale is OFF, the bitrate is (more or less) constant (CBR mode).
  
  See [[Bit rate]] page for details.
  
  Default range is [-1 ... -16]. This can be changed from config file, 
  but qscale is restricted to negative values only, 
  due to limitations in config file parser.
  
  QScale setting is not saved; it is applied only when you select this option
  from menu. It may be overwritten by camera firmware when changing video modes.
  When the camera starts, it is OFF.
  
  You can change QScale before starting recording, or right in the middle of the movie!

**Save config**
  Save current settings to ``MAGIC.CFG``.

**Draw palette**
  Tests the 8-bit bitmap palette, which is used for video overlays. See [[VRAM]].

**Screenshot (10 s)**
  Print screen after 10 seconds (it saves a BMP file). 
  Only the bitmap overlays are included in the screenshot (i.e. no live view image).

**Dump dmlog**
  Saves a log which contains DebugMsg output.
  See [[Debugging Magic Lantern]] page.

**Toggle draw_prop**
  Display property changes in real-time.
  See [[Properties]].

**Toggle draw_event**
  Display GUI events in real-time.
  See [[GUI_Events/550D]].

**Toggle mem_spy**
  Display memory addresses which change, but not those which change like mad. 
  Useful for detecting interesting addresses inside the camera RAM (like sensor & button locations).
  
  Start address and size is selected with the hidden settings ``debug.mem-spy.*``
  (see ``debug.c`` for details). You can also display only "small" or "boolean" values.
  
  Trying to spy the camera_engine addresses seems to cause trouble (camera freeze). 
  Probably it's not safe to read data from those areas.

**Powersave**
  Disable the powersave so that the LiveView never shuts off.

  WARNING -- this can cause problems with your sensor!

  **DO NOT LEAVE THE CAMERA ON CONTINUOUSLY!**

Some items from this menu may not be available in release builds; 
you can uncomment them from ``debug.c`` and create a custom ``autoexec.bin``.

Boot
~~~~

.. image:: BootMenu-550D.png
    :alt: thumb|right|Boot menu

Settings related to the Magic Lantern boot process.

**Write MBR**
  Try to make the card bootable, by writing the two labels (EOS_DEVELOP and BOOTDISK) to the MBR. Does not work yet.

**Autoboot: ON/OFF**
  Toggle the ``DISKBOOT`` flag in the NVRAM by calling ``bootdisk_enable()`` / ``bootdisk_disable()``
  (these are registered by camera FW as eventprocs with names ``EnableBootDisk`` and  ``DisableBootDisk``).
  
  If you disable Autoboot, Magic Lantern won't boot any more (you will have to reinstall it).
  
  If you do not have access to the menu, you can use the hidden setting ``magic.disable_bootdiskf`` for this.

This menu may not be available in release builds, 
because these settings are potentially dangerous.

Features which are not in menu
------------------------------

Movie logging
~~~~~~~~~~~~~

Magic Lantern will write out a metadata file for the each movie to ``MOV_1234.LOG`` (numbered after the movie), as well as a timestamp every time any of the parameters is changed during recording. 
Log files are placed in the same folder as the movies: ``DCIM/100CANON/``, ``101CANON`` etc.

Time remaining display
~~~~~~~~~~~~~~~~~~~~~~

When recording a movie, ML will display a small time counter in the upper right corner, 
which shows the estimated amount of recording time remaining on the card.

Unlike Canon's timer which assumes constant bitrate, ML timer assumes variable bitrate and works even if QScale is enabled.
However, due to variations in bitrate, the estimated value will fluctuate a lot, and this is normal.

Extra info displays
-------------------

Main shooting screen (outside LiveView)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

* Clock (bottom of screen)
* ISO value in finer increments (above Canon's ISO display)
* Trap Focus status (near MF icon)
* Kelvin temperature (in the white balance box)
* WB shift values for BA and GM

MENU->DISP
~~~~~~~~~~

* Shutter counter. Only counts pictures taken, not LV switches or quick focus attempts. 
* CMOS temp: temperature of the CMOS sensor (EFIC temperature), in raw units. Before, this was in the Debug menu.
* Lens name

LiveView
~~~~~~~~

* Aperture, shutter, ISO
* Spotmeter: brightness percentage from the center of the frame. Computed as average value of Y component from YUV LiveView buffer over a very small area.
* Lens focal length and focus distance
* Exposure compensation (codenamed AE)
